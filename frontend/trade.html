<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trade - FYNOR</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="alternate icon" href="favicon.ico">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>

<body>
    <!-- Header -->
    <div id="header-container"></div>

    <!-- Trading Interface -->
    <div class="trade-container">
        <!-- Order Book -->
        <div class="orderbook">
            <h3 style="margin-bottom: 1rem;">Order Book</h3>
            <div class="orderbook-header">
                <span>Price (USDT)</span>
                <span>Amount (BTC)</span>
            </div>
            <div id="orderbookSells">
                <!-- Sell orders -->
            </div>
            <div
                style="padding: 1rem 0; text-align: center; font-weight: 700; font-size: 1.25rem; color: var(--secondary-color);">
                $43,250.50
            </div>
            <div id="orderbookBuys">
                <!-- Buy orders -->
            </div>
        </div>

        <!-- Chart Area -->
        <div class="chart-area" style="display: flex; flex-direction: column;">
            <div class="pair-header">
                <div class="pair-info">
                    <h2>BTC/USDT</h2>
                    <div class="pair-price">$43,250.50</div>
                </div>
                <div style="color: var(--text-secondary);">
                    <div>24h Change: <span style="color: var(--secondary-color);">+2.5%</span></div>
                    <div>24h High: $44,000</div>
                    <div>24h Low: $42,800</div>
                    <div>24h Volume: 1,250.75 BTC</div>
                </div>
            </div>

            <div id="tv_chart_container" style="flex: 1; min-height: 400px;"></div>
        </div>

        <!-- Order Panel -->
        <div class="order-panel">
            <div class="order-tabs">
                <button class="order-tab active" onclick="switchOrderType('buy')">Buy</button>
                <button class="order-tab" onclick="switchOrderType('sell')">Sell</button>
            </div>

            <form id="orderForm" class="order-form" onsubmit="placeOrder(event)">
                <div class="order-input-group">
                    <label>Price</label>
                    <div class="order-input">
                        <input type="number" id="orderPrice" step="0.01" value="43250.50" required>
                        <span class="order-input-suffix">USDT</span>
                    </div>
                </div>

                <div class="order-input-group">
                    <label>Amount</label>
                    <div class="order-input">
                        <input type="number" id="orderAmount" step="0.00000001" placeholder="0.00000000" required>
                        <span class="order-input-suffix">BTC</span>
                    </div>
                </div>

                <div class="order-input-group">
                    <label>Amount (%)</label>
                    <input type="range" class="order-slider" min="0" max="100" value="0"
                        onchange="updateAmountFromSlider(this.value)">
                    <div
                        style="display: flex; justify-content: space-between; font-size: 0.75rem; color: var(--text-secondary);">
                        <span>0%</span>
                        <span>25%</span>
                        <span>50%</span>
                        <span>75%</span>
                        <span>100%</span>
                    </div>
                </div>

                <div class="order-summary">
                    <span>Available:</span>
                    <span id="availableBalance">1000.00 USDT</span>
                </div>

                <button type="submit" id="orderSubmitBtn" class="btn btn-primary btn-full">
                    Buy BTC
                </button>
            </form>

            <div style="margin-top: 2rem; padding-top: 1rem; border-top: 1px solid var(--border-color);">
                <h4 style="margin-bottom: 1rem;">Open Orders</h4>
                <div id="openOrders" style="color: var(--text-secondary); text-align: center; padding: 2rem;">
                    No open orders
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <div id="footer-container"></div>

    <script src="js/components.js"></script>
    <script src="app.js"></script>
    <script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>
    <script>
        // Initialize TradingView Widget
        document.addEventListener('DOMContentLoaded', () => {
            const urlParams = new URLSearchParams(window.location.search);
            const symbol = urlParams.get('symbol') || 'BTC/USDT';
            const tvSymbol = "BINANCE:" + symbol.replace('/', '');

            new TradingView.widget({
                "autosize": true,
                "symbol": tvSymbol,
                "interval": "D",
                "timezone": "Etc/UTC",
                "theme": "dark",
                "style": "1",
                "locale": "en",
                "toolbar_bg": "#f1f3f6",
                "enable_publishing": false,
                "allow_symbol_change": true,
                "container_id": "tv_chart_container"
            });

            generateOrderbook();
        });

        // Simple trading interface
        let currentOrderType = 'buy';

        function switchOrderType(type) {
            // ... existing code ...
            currentOrderType = type;
            const tabs = document.querySelectorAll('.order-tab');
            tabs.forEach(tab => tab.classList.remove('active'));
            event.target.classList.add('active');

            const submitBtn = document.getElementById('orderSubmitBtn');
            submitBtn.textContent = type === 'buy' ? 'Buy BTC' : 'Sell BTC';
            submitBtn.className = type === 'buy' ? 'btn btn-primary btn-full' : 'btn btn-danger btn-full';
        }

        function updateAmountFromSlider(percentage) {
            // Calculate amount based on percentage
            const price = parseFloat(document.getElementById('orderPrice').value);
            const available = 1000; // Example available balance
            const amount = (available * (percentage / 100)) / price;
            document.getElementById('orderAmount').value = amount.toFixed(8);
        }

        // Generate sample orderbook
        function generateOrderbook() {
            const basePrice = 43250.50;
            const sellsDiv = document.getElementById('orderbookSells');
            const buysDiv = document.getElementById('orderbookBuys');

            // Generate sells (asks)
            for (let i = 10; i > 0; i--) {
                const price = basePrice + (i * 10);
                const amount = (Math.random() * 2).toFixed(8);
                const row = document.createElement('div');
                row.className = 'orderbook-row';
                row.innerHTML = `
                    <span class="price-sell">${price.toFixed(2)}</span>
                    <span>${amount}</span>
                `;
                sellsDiv.appendChild(row);
            }

            // Generate buys (bids)
            for (let i = 1; i <= 10; i++) {
                const price = basePrice - (i * 10);
                const amount = (Math.random() * 2).toFixed(8);
                const row = document.createElement('div');
                row.className = 'orderbook-row';
                row.innerHTML = `
                    <span class="price-buy">${price.toFixed(2)}</span>
                    <span>${amount}</span>
                `;
                buysDiv.appendChild(row);
            }
        }

        // Initialize
        document.addEventListener('DOMContentLoaded', () => {
            generateOrderbook();
        });
    </script>
</body>

</html>